[{"title":"Pwn","url":"http://yoursite.com/2017/08/06/Pwn/","content":"<h1 id=\"Pwn\"><a href=\"#Pwn\" class=\"headerlink\" title=\"Pwn\"></a>Pwn</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7\">通用技巧</a><ul>\n<li><a href=\"#linux%E5%91%BD%E4%BB%A4\">Linux命令</a><ul>\n<li><a href=\"#ropgadget\">ROPgadget</a></li>\n</ul>\n</li>\n<li><a href=\"#gdb\">GDB</a><ul>\n<li><a href=\"#peda\">peda</a></li>\n<li><a href=\"#pwndbg\">pwndbg</a></li>\n</ul>\n</li>\n<li><a href=\"#pwntools\">Pwntools</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%A0%88%E6%BA%A2%E5%87%BA\">栈溢出</a><ul>\n<li><a href=\"#rop\">ROP</a><ul>\n<li><a href=\"#ret2text\">Ret2Text</a><ul>\n<li><a href=\"#%E9%A2%98%E7%9B%AE\">题目</a></li>\n</ul>\n</li>\n<li><a href=\"#ret2shellcode\">Ret2ShellCode</a></li>\n<li><a href=\"#ret2syscall\">Ret2SysCall</a><ul>\n<li><a href=\"#%E7%90%86%E8%AE%BA\">理论</a></li>\n<li><a href=\"#%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE\">相关题目</a></li>\n</ul>\n</li>\n<li><a href=\"#ret2libc\">Ret2Libc</a></li>\n</ul>\n</li>\n<li><a href=\"#advanced-rop\">Advanced ROP</a><ul>\n<li><a href=\"#ret2libcscuinit\">Ret2__libc_scu_init</a></li>\n<li><a href=\"#ret2-dlresolve\">Ret2 dl_resolve</a></li>\n<li><a href=\"#srop\">SROP</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E5%A0%86%E6%BA%A2%E5%87%BA\">堆溢出</a></li>\n<li><a href=\"#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2\">格式化字符串</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0\">参考文章</a></li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"通用技巧\"><a href=\"#通用技巧\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h2><h3 id=\"Linux命令\"><a href=\"#Linux命令\" class=\"headerlink\" title=\"Linux命令\"></a>Linux命令</h3><ul>\n<li>readelf<ul>\n<li><code>.dynamic</code> section: <code>readelf -d</code></li>\n<li><code>.rel.plt;.rel.dyn</code> section: <code>readelf -r</code></li>\n<li><code>.dynsym</code> section: <code>readelf -s</code></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"ROPgadget\"><a href=\"#ROPgadget\" class=\"headerlink\" title=\"ROPgadget\"></a>ROPgadget</h4><ul>\n<li><code>ROPgadget --binary bin --string  &quot;/bin/sh&quot;</code></li>\n</ul>\n<h3 id=\"GDB\"><a href=\"#GDB\" class=\"headerlink\" title=\"GDB\"></a>GDB</h3><h4 id=\"peda\"><a href=\"#peda\" class=\"headerlink\" title=\"peda\"></a>peda</h4><h4 id=\"pwndbg\"><a href=\"#pwndbg\" class=\"headerlink\" title=\"pwndbg\"></a>pwndbg</h4><ul>\n<li>heap 命令不支持32位程序</li>\n</ul>\n<blockquote>\n<p>dpkg –add-architecture i386<br>apt-get install libc6:i386<br>apt-get install libc6-dbg:i386</p>\n</blockquote>\n<h3 id=\"Pwntools\"><a href=\"#Pwntools\" class=\"headerlink\" title=\"Pwntools\"></a>Pwntools</h3><h2 id=\"栈溢出\"><a href=\"#栈溢出\" class=\"headerlink\" title=\"栈溢出\"></a>栈溢出</h2><h3 id=\"ROP\"><a href=\"#ROP\" class=\"headerlink\" title=\"ROP\"></a>ROP</h3><h4 id=\"Ret2Text\"><a href=\"#Ret2Text\" class=\"headerlink\" title=\"Ret2Text\"></a>Ret2Text</h4><p>ret2text即需要我们控制程序执行程序本身已有的的代码(.text)</p>\n<h5 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h5><ul>\n<li><a href=\"https://github.com/ctfs/write-ups-2013/tree/master/pico-ctf-2013/rop-1\" target=\"_blank\" rel=\"external\">pico-ctf-2013:rop-1</a></li>\n<li><a href=\"https://github.com/ctfs/write-ups-2013/tree/master/pico-ctf-2013/rop-2\" target=\"_blank\" rel=\"external\">pico-ctf-2013:rop-2</a></li>\n</ul>\n<h4 id=\"Ret2ShellCode\"><a href=\"#Ret2ShellCode\" class=\"headerlink\" title=\"Ret2ShellCode\"></a>Ret2ShellCode</h4><p>ret2shellcode需要我们控制程序执行shellcode代码。</p>\n<h4 id=\"Ret2SysCall\"><a href=\"#Ret2SysCall\" class=\"headerlink\" title=\"Ret2SysCall\"></a>Ret2SysCall</h4><h5 id=\"理论\"><a href=\"#理论\" class=\"headerlink\" title=\"理论\"></a>理论</h5><p>ret2syscall需要我们控制程序执行系统调用，获取shell  </p>\n<p>系统调用执行条件: </p>\n<ul>\n<li>把系统调用的编号存入 EAX  </li>\n<li>把函数参数存入其它通用寄存器  </li>\n<li>触发 0x80 号中断（int 0x80）  </li>\n</ul>\n<p>例如：</p>\n<p>执行<code>execve(&quot;/bin/sh&quot;,NULL,NULL)</code></p>\n<p>X86下</p>\n<ul>\n<li>系统调用号即eax应该为0xb</li>\n<li>第一个参数即ebx应该指向/bin/sh的地址</li>\n<li>第二个参数即ecx应该为0</li>\n<li>第三个参数edx应该为0</li>\n</ul>\n<h5 id=\"相关题目\"><a href=\"#相关题目\" class=\"headerlink\" title=\"相关题目\"></a>相关题目</h5><ul>\n<li><a href=\"http://vancir.com/posts/ret2syscall%E6%94%BB%E5%87%BB%E6%8A%80%E6%9C%AF%E7%A4%BA%E4%BE%8B\" target=\"_blank\" rel=\"external\">ret2syscall攻击技术示例</a></li>\n</ul>\n<h4 id=\"Ret2Libc\"><a href=\"#Ret2Libc\" class=\"headerlink\" title=\"Ret2Libc\"></a>Ret2Libc</h4><p>ret2libc即控制函数的执行 libc中的函数，通常是返回至某个函数的plt处或者函数的具体位置(即函数对应的got表项的内容)</p>\n<h3 id=\"Advanced-ROP\"><a href=\"#Advanced-ROP\" class=\"headerlink\" title=\"Advanced ROP\"></a>Advanced ROP</h3><h4 id=\"Ret2-libc-scu-init\"><a href=\"#Ret2-libc-scu-init\" class=\"headerlink\" title=\"Ret2__libc_scu_init\"></a>Ret2__libc_scu_init</h4><h4 id=\"Ret2-dl-resolve\"><a href=\"#Ret2-dl-resolve\" class=\"headerlink\" title=\"Ret2 dl_resolve\"></a>Ret2 dl_resolve</h4><h4 id=\"SROP\"><a href=\"#SROP\" class=\"headerlink\" title=\"SROP\"></a>SROP</h4><h2 id=\"堆溢出\"><a href=\"#堆溢出\" class=\"headerlink\" title=\"堆溢出\"></a>堆溢出</h2><h2 id=\"格式化字符串\"><a href=\"#格式化字符串\" class=\"headerlink\" title=\"格式化字符串\"></a>格式化字符串</h2><h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2>","categories":["CTF","Pwn"],"tags":["Pwn"]},{"title":"Misc","url":"http://yoursite.com/2017/08/06/Misc/","content":"<h1 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2\">编码转换</a></li>\n<li><a href=\"#%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81--%E9%9A%90%E5%86%99%E5%88%86%E6%9E%90\">数字取证 &amp;&amp; 隐写分析</a><ul>\n<li><a href=\"#%E5%9B%BE%E7%89%87\">图片</a><ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7\">通用技巧</a><ul>\n<li><a href=\"#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\">常用命令</a></li>\n</ul>\n</li>\n<li><a href=\"#png\">PNG</a></li>\n<li><a href=\"#jpg\">JPG</a></li>\n<li><a href=\"#gif\">GIF</a></li>\n</ul>\n</li>\n<li><a href=\"#%E9%9F%B3%E9%A2%91%E6%96%87%E4%BB%B6\">音频文件</a></li>\n<li><a href=\"#%E5%8E%8B%E7%BC%A9%E5%8C%85\">压缩包</a><ul>\n<li><a href=\"#zip\">Zip</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%B5%81%E9%87%8F%E5%8C%85\">流量包</a></li>\n</ul>\n</li>\n<li><a href=\"#%E8%84%91%E5%9B%BE\">脑图</a></li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"编码转换\"><a href=\"#编码转换\" class=\"headerlink\" title=\"编码转换\"></a>编码转换</h2><ul>\n<li><p>Other</p>\n<ul>\n<li><p>代码类编码，附一个<a href=\"https://tio.run/#\" target=\"_blank\" rel=\"external\">在线编辑器</a></p>\n<blockquote>\n<p>知乎上有个<a href=\"https://www.zhihu.com/question/63387608\" target=\"_blank\" rel=\"external\">讨论帖</a><br><a href=\"https://esolangs.org/wiki/Hello_world_program_in_esoteric_languages\" target=\"_blank\" rel=\"external\">hello world in esoteric languages</a></p>\n</blockquote>\n<ul>\n<li><p><a href=\"http://tool.ph0en1x.com/brainfuck/\" target=\"_blank\" rel=\"external\">BrainFuck</a></p>\n<p><code>++++++++++[&gt;+++++++&gt;++++++++++&gt;+++&gt;+&lt;&lt;&lt;&lt;-]&gt;++.&gt;+.+++++++..+++.&gt;++.&lt;&lt;+++++++++++++++.&gt;.+++.------.--------.&gt;+.&gt;.</code></p>\n</li>\n<li><p><a href=\"http://tool.ph0en1x.com/brainfuck/\" target=\"_blank\" rel=\"external\">Ook</a></p>\n<p><code>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook!</code></p>\n</li>\n<li><p>JsFuck</p>\n<p><code>[ ]( ) ! +</code></p>\n</li>\n<li><p><a href=\"http://tmxk.org/jother/\" target=\"_blank\" rel=\"external\">Jother</a></p>\n<p><code>! + ( ) [ ] { }</code></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"数字取证-amp-amp-隐写分析\"><a href=\"#数字取证-amp-amp-隐写分析\" class=\"headerlink\" title=\"数字取证 &amp;&amp; 隐写分析\"></a>数字取证 &amp;&amp; 隐写分析</h2><h3 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h3><h4 id=\"通用技巧\"><a href=\"#通用技巧\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h4><h5 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h5><ul>\n<li><a href=\"https://www.imagemagick.org/script/escape.php\" target=\"_blank\" rel=\"external\">identift -format 参数</a></li>\n</ul>\n<h4 id=\"PNG\"><a href=\"#PNG\" class=\"headerlink\" title=\"PNG\"></a>PNG</h4><ul>\n<li><p>LSB隐写</p>\n</li>\n<li><p>Steg Software</p>\n</li>\n</ul>\n<h4 id=\"JPG\"><a href=\"#JPG\" class=\"headerlink\" title=\"JPG\"></a>JPG</h4><ul>\n<li>Steg Software</li>\n</ul>\n<h4 id=\"GIF\"><a href=\"#GIF\" class=\"headerlink\" title=\"GIF\"></a>GIF</h4><ul>\n<li>时间轴</li>\n<li>空间域</li>\n</ul>\n<h3 id=\"音频文件\"><a href=\"#音频文件\" class=\"headerlink\" title=\"音频文件\"></a>音频文件</h3><ul>\n<li>频谱</li>\n<li>波形</li>\n<li>Steg Software</li>\n</ul>\n<h3 id=\"压缩包\"><a href=\"#压缩包\" class=\"headerlink\" title=\"压缩包\"></a>压缩包</h3><h4 id=\"Zip\"><a href=\"#Zip\" class=\"headerlink\" title=\"Zip\"></a>Zip</h4><ul>\n<li>爆破</li>\n<li>CRC32爆破</li>\n<li>明文攻击</li>\n<li>伪加密</li>\n</ul>\n<h3 id=\"流量包\"><a href=\"#流量包\" class=\"headerlink\" title=\"流量包\"></a>流量包</h3><h2 id=\"脑图\"><a href=\"#脑图\" class=\"headerlink\" title=\"脑图\"></a>脑图</h2><p><img src=\"/2017/08/06/Misc/Misc.png\" alt=\"1\"></p>\n","categories":["CTF","Misc"],"tags":["Misc"]},{"title":"标签","url":"http://yoursite.com/tags/index.html","content":"","categories":[],"tags":[]},{"title":"分类","url":"http://yoursite.com/categories/index.html","content":"","categories":[],"tags":[]}]