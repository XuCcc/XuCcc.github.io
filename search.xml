[{"title":"Pwn","url":"http://yoursite.com/2017/08/06/Pwn/","content":"<h1 id=\"Pwn\"><a href=\"#Pwn\" class=\"headerlink\" title=\"Pwn\"></a>Pwn</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7\">通用技巧</a><ul>\n<li><a href=\"#linux%E5%91%BD%E4%BB%A4\">Linux命令</a><ul>\n<li><a href=\"#ropgadget\">ROPgadget</a></li>\n</ul>\n</li>\n<li><a href=\"#gdb\">GDB</a></li>\n<li><a href=\"#pwntolls\">Pwntolls</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%A0%88%E6%BA%A2%E5%87%BA\">栈溢出</a><ul>\n<li><a href=\"#rop\">ROP</a><ul>\n<li><a href=\"#ret2text\">Ret2Text</a><ul>\n<li><a href=\"#%E9%A2%98%E7%9B%AE\">题目</a></li>\n</ul>\n</li>\n<li><a href=\"#ret2shellcode\">Ret2ShellCode</a></li>\n<li><a href=\"#ret2syscall\">Ret2SysCall</a><ul>\n<li><a href=\"#%E7%90%86%E8%AE%BA\">理论</a></li>\n<li><a href=\"#%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE\">相关题目</a></li>\n</ul>\n</li>\n<li><a href=\"#ret2libc\">Ret2Libc</a></li>\n<li><a href=\"#ret2libcscuinit\">Ret2__libc_scu_init</a></li>\n<li><a href=\"#srop\">SROP</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E5%A0%86%E6%BA%A2%E5%87%BA\">堆溢出</a></li>\n<li><a href=\"#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2\">格式化字符串</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0\">参考文章</a></li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"通用技巧\"><a href=\"#通用技巧\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h2><h3 id=\"Linux命令\"><a href=\"#Linux命令\" class=\"headerlink\" title=\"Linux命令\"></a>Linux命令</h3><h4 id=\"ROPgadget\"><a href=\"#ROPgadget\" class=\"headerlink\" title=\"ROPgadget\"></a>ROPgadget</h4><ul>\n<li><code>ROPgadget --binary bin --string  &quot;/bin/sh&quot;</code></li>\n</ul>\n<h3 id=\"GDB\"><a href=\"#GDB\" class=\"headerlink\" title=\"GDB\"></a>GDB</h3><h3 id=\"Pwntolls\"><a href=\"#Pwntolls\" class=\"headerlink\" title=\"Pwntolls\"></a>Pwntolls</h3><h2 id=\"栈溢出\"><a href=\"#栈溢出\" class=\"headerlink\" title=\"栈溢出\"></a>栈溢出</h2><h3 id=\"ROP\"><a href=\"#ROP\" class=\"headerlink\" title=\"ROP\"></a>ROP</h3><h4 id=\"Ret2Text\"><a href=\"#Ret2Text\" class=\"headerlink\" title=\"Ret2Text\"></a>Ret2Text</h4><p>ret2text即需要我们控制程序执行程序本身已有的的代码(.text)</p>\n<h5 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h5><ul>\n<li><a href=\"https://github.com/ctfs/write-ups-2013/tree/master/pico-ctf-2013/rop-1\" target=\"_blank\" rel=\"external\">pico-ctf-2013:rop-1</a></li>\n<li><a href=\"https://github.com/ctfs/write-ups-2013/tree/master/pico-ctf-2013/rop-2\" target=\"_blank\" rel=\"external\">pico-ctf-2013:rop-2</a></li>\n</ul>\n<h4 id=\"Ret2ShellCode\"><a href=\"#Ret2ShellCode\" class=\"headerlink\" title=\"Ret2ShellCode\"></a>Ret2ShellCode</h4><p>ret2shellcode需要我们控制程序执行shellcode代码。</p>\n<h4 id=\"Ret2SysCall\"><a href=\"#Ret2SysCall\" class=\"headerlink\" title=\"Ret2SysCall\"></a>Ret2SysCall</h4><h5 id=\"理论\"><a href=\"#理论\" class=\"headerlink\" title=\"理论\"></a>理论</h5><p>ret2syscall需要我们控制程序执行系统调用，获取shell  </p>\n<p>系统调用执行条件: </p>\n<ul>\n<li>把系统调用的编号存入 EAX  </li>\n<li>把函数参数存入其它通用寄存器  </li>\n<li>触发 0x80 号中断（int 0x80）  </li>\n</ul>\n<p>例如：</p>\n<p>执行<code>execve(&quot;/bin/sh&quot;,NULL,NULL)</code></p>\n<p>X86下</p>\n<ul>\n<li>系统调用号即eax应该为0xb</li>\n<li>第一个参数即ebx应该指向/bin/sh的地址</li>\n<li>第二个参数即ecx应该为0</li>\n<li>第三个参数edx应该为0</li>\n</ul>\n<h5 id=\"相关题目\"><a href=\"#相关题目\" class=\"headerlink\" title=\"相关题目\"></a>相关题目</h5><ul>\n<li><a href=\"http://vancir.com/posts/ret2syscall%E6%94%BB%E5%87%BB%E6%8A%80%E6%9C%AF%E7%A4%BA%E4%BE%8B\" target=\"_blank\" rel=\"external\">ret2syscall攻击技术示例</a></li>\n</ul>\n<h4 id=\"Ret2Libc\"><a href=\"#Ret2Libc\" class=\"headerlink\" title=\"Ret2Libc\"></a>Ret2Libc</h4><p>ret2libc即控制函数的执行 libc中的函数，通常是返回至某个函数的plt处或者函数的具体位置(即函数对应的got表项的内容)</p>\n<h4 id=\"Ret2-libc-scu-init\"><a href=\"#Ret2-libc-scu-init\" class=\"headerlink\" title=\"Ret2__libc_scu_init\"></a>Ret2__libc_scu_init</h4><h4 id=\"SROP\"><a href=\"#SROP\" class=\"headerlink\" title=\"SROP\"></a>SROP</h4><h2 id=\"堆溢出\"><a href=\"#堆溢出\" class=\"headerlink\" title=\"堆溢出\"></a>堆溢出</h2><h2 id=\"格式化字符串\"><a href=\"#格式化字符串\" class=\"headerlink\" title=\"格式化字符串\"></a>格式化字符串</h2><h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2>","categories":["CTF","Pwn"],"tags":["Pwn"]},{"title":"Misc","url":"http://yoursite.com/2017/08/06/Misc/","content":"<h1 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h1><!-- MarkdownTOC -->\n<ul>\n<li><a href=\"#%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2\">编码转换</a></li>\n<li><a href=\"#%E5%90%84%E7%B1%BB%E6%96%87%E4%BB%B6\">各类文件</a><ul>\n<li><a href=\"#%E5%9B%BE%E7%89%87\">图片</a><ul>\n<li><a href=\"#%E9%80%9A%E7%94%A8%E6%8A%80%E5%B7%A7\">通用技巧</a><ul>\n<li><a href=\"#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\">常用命令</a></li>\n</ul>\n</li>\n<li><a href=\"#png\">PNG</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<!-- /MarkdownTOC -->\n<h2 id=\"编码转换\"><a href=\"#编码转换\" class=\"headerlink\" title=\"编码转换\"></a>编码转换</h2><ul>\n<li><a href=\"http://ideone.com/\" target=\"_blank\" rel=\"external\">whitespace</a></li>\n</ul>\n<h2 id=\"各类文件\"><a href=\"#各类文件\" class=\"headerlink\" title=\"各类文件\"></a>各类文件</h2><h3 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h3><h4 id=\"通用技巧\"><a href=\"#通用技巧\" class=\"headerlink\" title=\"通用技巧\"></a>通用技巧</h4><h5 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h5><ul>\n<li><a href=\"https://www.imagemagick.org/script/escape.php\" target=\"_blank\" rel=\"external\">identift -format 参数</a></li>\n</ul>\n<h4 id=\"PNG\"><a href=\"#PNG\" class=\"headerlink\" title=\"PNG\"></a>PNG</h4><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></div><div class=\"line\"><span class=\"comment\"># @Date    : 2017-04-17 22:35:49</span></div><div class=\"line\"><span class=\"comment\"># @Author  : Xu (2604133533@qq.com)</span></div><div class=\"line\"><span class=\"comment\"># @Link    : http://xu.org</span></div><div class=\"line\"><span class=\"comment\"># @Version : v2.5</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> os</div><div class=\"line\"><span class=\"keyword\">import</span> requests</div><div class=\"line\"><span class=\"keyword\">import</span> time</div><div class=\"line\"><span class=\"keyword\">import</span> re</div><div class=\"line\"></div><div class=\"line\">url_platform = <span class=\"string\">'http://172.16.4.1/Common/submitAnswer/'</span>\t\t<span class=\"comment\">#提交平台</span></div><div class=\"line\">token = <span class=\"string\">'d3055b08d5c27fb97bf3898cf523d10e'</span> \t\t<span class=\"comment\"># 队伍token</span></div><div class=\"line\">method = <span class=\"string\">'POST'</span> \t<span class=\"comment\">#提交方式</span></div><div class=\"line\">targets = [<span class=\"string\">'http://172.16.5.'</span> + str(i) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">10</span>,<span class=\"number\">61</span>,<span class=\"number\">1</span>)]\t\t<span class=\"comment\">#目标IP池</span></div><div class=\"line\">ports_pwn = [<span class=\"string\">'20002'</span>, <span class=\"string\">'20003'</span>]\t\t<span class=\"comment\">#Pwn 端口</span></div><div class=\"line\">payloads = [&#123;<span class=\"string\">'port'</span>: <span class=\"number\">5007</span>, <span class=\"string\">'method'</span>: <span class=\"string\">'GET'</span>, <span class=\"string\">'url'</span>:<span class=\"string\">'/tmp/bendawang.php'</span>, <span class=\"string\">'parameter'</span>: &#123;<span class=\"string\">'a'</span>: <span class=\"string\">'1'</span>&#125;&#125;,</div><div class=\"line\">           ]\t\t<span class=\"comment\"># Web EXP</span></div><div class=\"line\"></div><div class=\"line\">sign = <span class=\"string\">'p'</span>\t<span class=\"comment\"># 提交成功标志</span></div><div class=\"line\">pattern_flag = re.compile(<span class=\"string\">\"\\w&#123;8&#125;\\-\\w&#123;4&#125;-\\w&#123;4&#125;-\\w&#123;4&#125;-\\w&#123;8&#125;\"</span>)\t\t<span class=\"comment\"># 检索flag</span></div><div class=\"line\">time_round = <span class=\"number\">300</span>\t<span class=\"comment\"># 每轮时间 单位秒</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">web</span><span class=\"params\">()</span>:</span></div><div class=\"line\">\tsuccess_exp = []</div><div class=\"line\">\t<span class=\"keyword\">print</span> </div><div class=\"line\">\t<span class=\"keyword\">for</span> target <span class=\"keyword\">in</span> targets:</div><div class=\"line\">\t\t<span class=\"keyword\">for</span> payload <span class=\"keyword\">in</span> payloads:</div><div class=\"line\">\t\t\tserver = target + <span class=\"string\">':'</span> + str(payload[<span class=\"string\">'port'</span>])</div><div class=\"line\">\t\t\turl_exp =  server + payload[<span class=\"string\">'url'</span>]</div><div class=\"line\">\t\t\t<span class=\"keyword\">try</span>:</div><div class=\"line\">\t\t\t\treq = requests.get(url_exp,timeout=<span class=\"number\">3</span>)</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">print</span> url_exp + <span class=\"string\">'\\t'</span>,</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">print</span> req</div><div class=\"line\">\t\t\t<span class=\"keyword\">except</span>:</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">pass</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">web()</div></pre></td></tr></table></figure>","categories":["CTF","Misc"],"tags":["Misc"]},{"title":"标签","url":"http://yoursite.com/tags/index.html","content":"","categories":[],"tags":[]},{"title":"分类","url":"http://yoursite.com/categories/index.html","content":"","categories":[],"tags":[]}]